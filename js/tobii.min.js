!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Tobii=t()}(this,(function(){"use strict";return function(e){var t=Math.abs,r={},n=window,i=0,a=null,o=null,d=null,l=null,s=null,u={},c=!1,p=!1,f=!1,b=null,m=null,h=null,g=null,v=null,y=!1,A=!1,w=[],E=[],L=0,x={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},C={},S=null,_=null,I={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(e,t){var n=document.createElement("figure"),a=document.createElement("figcaption"),o=document.createElement("img"),d=e.querySelector("img"),l=document.createElement("div");n.style.opacity="0",d&&(o.alt=d.alt||""),o.setAttribute("src",""),o.setAttribute("data-src",e.href),n.appendChild(o),r.captions&&("self"===r.captionsSelector&&e.getAttribute(r.captionAttribute)?a.textContent=e.getAttribute(r.captionAttribute):"img"===r.captionsSelector&&d&&d.getAttribute(r.captionAttribute)&&(a.textContent=d.getAttribute(r.captionAttribute)),a.textContent&&(a.id="tobii-figcaption-"+i,n.appendChild(a),o.setAttribute("aria-labelledby",a.id),++i)),t.appendChild(n),l.className="tobii-loader",l.setAttribute("role","progressbar"),l.setAttribute("aria-label",r.loadingIndicatorLabel),t.appendChild(l),t.setAttribute("data-type","image")},onPreload:function(e){I.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var r=e.querySelector("figure"),n=e.querySelector(".tobii-loader");t.onload=function(){e.removeChild(n),r.style.opacity="1"},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(){},onCleanup:function(){}},html:{checkSupport:function(e){return oe(e,"html")},init:function(e,t){var r=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),n=document.querySelector(r);if(!n)throw new Error("Ups, I can't find the target "+r+".");t.appendChild(n),t.setAttribute("data-type","html")},onPreload:function(){},onLoad:function(e){var t=e.querySelector("video");t&&(t.hasAttribute("data-time")&&0<t.readyState&&(t.currentTime=t.getAttribute("data-time")),r.autoplayVideo&&t.play())},onLeave:function(e){var t=e.querySelector("video");t&&(!t.paused&&t.pause(),0<t.readyState&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");if(t&&0<t.readyState&&3>t.readyState&&t.duration!==t.currentTime){var r=t.cloneNode(!0);de(t),t.load(),t.parentNode.removeChild(t),e.appendChild(r)}}},iframe:{checkSupport:function(e){return oe(e,"iframe")},init:function(e,t){var r=document.createElement("iframe"),n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");r.setAttribute("frameborder","0"),r.setAttribute("src",""),r.setAttribute("data-src",n),e.getAttribute("data-width")&&(r.style.maxWidth=e.getAttribute("data-width")+"px"),e.getAttribute("data-height")&&(r.style.maxHeight=e.getAttribute("data-height")+"px"),t.appendChild(r),t.setAttribute("data-type","iframe")},onPreload:function(){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(){},onCleanup:function(){}},youtube:{checkSupport:function(e){return oe(e,"youtube")},init:function(e,t){var r=document.createElement("div");t.appendChild(r),E[L]=new window.YT.Player(r,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",L),t.setAttribute("data-type","youtube"),L++},onPreload:function(){},onLoad:function(e){r.autoplayVideo&&E[e.getAttribute("data-player")].playVideo()},onLeave:function(e){1===E[e.getAttribute("data-player")].getPlayerState()&&E[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){1===E[e.getAttribute("data-player")].getPlayerState()&&E[e.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),r=t.length,n=Array(r);r--;)n[r]=[t[r],e[t[r]]];return n});var T=function(e,t){if(null===document.querySelector('[data-type="youtube"]')||A)O(e,t);else{if(null===document.getElementById("iframe_api")){var r=document.createElement("script"),n=document.getElementsByTagName("script")[0];r.id="iframe_api",r.src="https://www.youtube.com/iframe_api",n.parentNode.insertBefore(r,n)}-1===w.indexOf(e)&&w.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(w,(function(e){O(e,t)})),A=!0}}},N=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},O=function(e,t){if(S=N(e),Object.prototype.hasOwnProperty.call(C,S)||(C[S]=function(e){return JSON.parse(JSON.stringify(e))}(x),q()),-1!==C[S].gallery.indexOf(e))throw new Error("Ups, element already added to the lightbox.");if(C[S].gallery.push(e),C[S].elementsLength++,r.zoom&&e.querySelector("img")){var n=document.createElement("div");n.className="tobii-zoom__icon",n.innerHTML=r.zoomText,e.classList.add("tobii-zoom"),e.appendChild(n)}e.addEventListener("click",W),X(e),ue()&&S===_&&(le(),se()),t&&t.call(this)},k=function(e,t){var n=N(e);if(-1===C[n].gallery.indexOf(e));else{var i=C[n].gallery.indexOf(e),a=C[n].sliderElements[i];if(C[n].elementsLength--,r.zoom&&e.querySelector(".tobii-zoom__icon")){var o=e.querySelector(".tobii-zoom__icon");o.parentNode.classList.remove("tobii-zoom"),o.parentNode.removeChild(o)}e.removeEventListener("click",W),a.parentNode.removeChild(a),ue()&&n===_&&(le(),se()),t&&t.call(this)}},P=function(){(a=document.createElement("div")).setAttribute("role","dialog"),a.setAttribute("aria-hidden","true"),a.className="tobii",(o=document.createElement("button")).className="tobii__prev",o.setAttribute("type","button"),o.setAttribute("aria-label",r.navLabel[0]),o.innerHTML=r.navText[0],a.appendChild(o),(d=document.createElement("button")).className="tobii__next",d.setAttribute("type","button"),d.setAttribute("aria-label",r.navLabel[1]),d.innerHTML=r.navText[1],a.appendChild(d),(l=document.createElement("button")).className="tobii__close",l.setAttribute("type","button"),l.setAttribute("aria-label",r.closeLabel),l.innerHTML=r.closeText,a.appendChild(l),(s=document.createElement("div")).className="tobii__counter",a.appendChild(s),document.body.appendChild(a)},q=function(){C[S].slider=document.createElement("div"),C[S].slider.className="tobii__slider",a.appendChild(C[S].slider)},X=function(e){for(var t in I)if(Object.prototype.hasOwnProperty.call(I,t)&&I[t].checkSupport(e)){var r=document.createElement("div"),n=document.createElement("div");r.className="tobii__slider-slide",r.style.position="absolute",r.style.left=100*C[S].x+"%",I[t].init(e,n),r.appendChild(n),C[S].slider.appendChild(r),C[S].sliderElements.push(r),++C[S].x;break}},Y=function(e,t){if(_=null===_?S:_,ue()||e||(e=0),ue()){if(!e)throw new Error("Ups, Tobii is aleady open.");if(e===C[_].currentIndex)throw new Error("Ups, slide "+e+" is already selected.")}if(-1===e||e>=C[_].elementsLength)throw new Error("Ups, I can't find slide "+e+".");r.hideScrollbar&&(document.documentElement.classList.add("tobii-is-open"),document.body.classList.add("tobii-is-open")),le(),r.close||(l.disabled=!1,l.setAttribute("aria-hidden","true")),b=document.activeElement,C[_].currentIndex=e,R(),ie(),j(C[_].currentIndex),a.setAttribute("aria-hidden","false"),se(),z(C[_].currentIndex+1),z(C[_].currentIndex-1),setTimeout((function(){C[_].slider.classList.add("tobii__slider--animate")}),1e3),t&&t.call(this)},M=function(e){if(!ue())throw new Error("Tobii is already closed.");r.hideScrollbar&&(document.documentElement.classList.remove("tobii-is-open"),document.body.classList.remove("tobii-is-open")),ae(),b.focus();var t=C[_].sliderElements[C[_].currentIndex].querySelector("[data-type]"),n=t.getAttribute("data-type");I[n].onLeave(t),I[n].onCleanup(t),a.setAttribute("aria-hidden","true"),C[_].currentIndex=0,C[_].slider.classList.remove("tobii__slider--animate"),e&&e.call(this)},z=function(e){if(void 0!==C[_].sliderElements[e]){var t=C[_].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");I[r].onPreload(t)}},j=function(e){if(void 0!==C[_].sliderElements[e]){var t=C[_].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");I[r].onLoad(t)}},D=function(e){0<C[_].currentIndex&&(V(C[_].currentIndex),j(--C[_].currentIndex),se("left"),H(C[_].currentIndex+1),z(C[_].currentIndex-1),e&&e.call(this))},U=function(e){C[_].currentIndex<C[_].elementsLength-1&&(V(C[_].currentIndex),j(++C[_].currentIndex),se("right"),H(C[_].currentIndex-1),z(C[_].currentIndex+1),e&&e.call(this))},V=function(e){if(void 0!==C[_].sliderElements[e]){var t=C[_].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");I[r].onLeave(t)}},H=function(e){if(void 0!==C[_].sliderElements[e]){var t=C[_].sliderElements[e].querySelector("[data-type]"),r=t.getAttribute("data-type");I[r].onCleanup(t)}},B=function(){g=-C[_=null===_?S:_].currentIndex*a.offsetWidth,C[_].slider.style.transform="translate3d("+g+"px, 0, 0)",v=g},R=function(){u={startX:0,endX:0,startY:0,endY:0}},G=function(){var e=u.endX-u.startX,n=u.endY-u.startY,i=t(e),a=t(n);0<e&&i>r.threshold&&0<C[_].currentIndex?D():0>e&&i>r.threshold&&C[_].currentIndex!==C[_].elementsLength-1?U():0>n&&a>r.threshold&&r.swipeClose?M():B()},J=function(){y||(y=!0,n.requestAnimationFrame((function(){B(),y=!1})))},W=function(e){e.preventDefault(),_=N(this),Y(C[_].gallery.indexOf(this))},F=function(e){e.target===o?D():e.target===d?U():(e.target===l||"tobii__slider-slide"===e.target.className&&r.docClose)&&M(),e.stopPropagation()},K=function(e){9===e.keyCode||"Tab"===e.code?e.shiftKey?document.activeElement===m&&(h.focus(),e.preventDefault()):document.activeElement===h&&(m.focus(),e.preventDefault()):27===e.keyCode||"Escape"===e.code?(e.preventDefault(),M()):37===e.keyCode||"ArrowLeft"===e.code?(e.preventDefault(),D()):(39===e.keyCode||"ArrowRight"===e.code)&&(e.preventDefault(),U())},$=function(e){pe(e.target)||(e.stopPropagation(),f=!0,u.startX=e.touches[0].pageX,u.startY=e.touches[0].pageY,C[_].slider.classList.add("tobii__slider--is-dragging"))},Q=function(e){e.stopPropagation(),f&&(e.preventDefault(),u.endX=e.touches[0].pageX,u.endY=e.touches[0].pageY,ne())},Z=function(e){e.stopPropagation(),f=!1,C[_].slider.classList.remove("tobii__slider--is-dragging"),u.endX&&(c=!1,p=!1,G()),R()},ee=function(e){pe(e.target)||(e.preventDefault(),e.stopPropagation(),f=!0,u.startX=e.pageX,u.startY=e.pageY,C[_].slider.classList.add("tobii__slider--is-dragging"))},te=function(e){e.preventDefault(),f&&(u.endX=e.pageX,u.endY=e.pageY,ne())},re=function(e){e.stopPropagation(),f=!1,C[_].slider.classList.remove("tobii__slider--is-dragging"),u.endX&&(c=!1,p=!1,G()),R()},ne=function(){var e=Math.round;0<t(u.startX-u.endX)&&!p&&r.swipeClose?(C[_].slider.style.transform="translate3d("+(v-e(u.startX-u.endX))+"px, 0, 0)",c=!0,p=!1):0<t(u.startY-u.endY)&&!c&&(C[_].slider.style.transform="translate3d("+v+"px, -"+e(u.startY-u.endY)+"px, 0)",c=!1,p=!0)},ie=function(){r.keyboard&&n.addEventListener("keydown",K),n.addEventListener("resize",J),a.addEventListener("click",F),r.draggable&&(ce()&&(a.addEventListener("touchstart",$),a.addEventListener("touchmove",Q),a.addEventListener("touchend",Z)),a.addEventListener("mousedown",ee),a.addEventListener("mouseup",re),a.addEventListener("mousemove",te))},ae=function(){r.keyboard&&n.removeEventListener("keydown",K),n.removeEventListener("resize",J),a.removeEventListener("click",F),r.draggable&&(ce()&&(a.removeEventListener("touchstart",$),a.removeEventListener("touchmove",Q),a.removeEventListener("touchend",Z)),a.removeEventListener("mousedown",ee),a.removeEventListener("mouseup",re),a.removeEventListener("mousemove",te))},oe=function(e,t){return e.getAttribute("data-type")===t},de=function(e){var t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,(function(e){e.setAttribute("src","")}))},le=function(){r.draggable&&1<C[_].elementsLength&&!C[_].slider.classList.contains("tobii__slider--is-draggable")&&C[_].slider.classList.add("tobii__slider--is-draggable"),!r.nav||1===C[_].elementsLength||"auto"===r.nav&&ce()?(o.setAttribute("aria-hidden","true"),d.setAttribute("aria-hidden","true")):(o.setAttribute("aria-hidden","false"),d.setAttribute("aria-hidden","false")),r.counter&&1!==C[_].elementsLength?s.setAttribute("aria-hidden","false"):s.setAttribute("aria-hidden","true")},se=function(e){(function(){for(var e in C)Object.prototype.hasOwnProperty.call(C,e)&&(C[e].slider.style.display=_===e?"block":"none")})(),B(),s.textContent=C[_].currentIndex+1+"/"+C[_].elementsLength,function(e){var t;r.nav?(o.disabled=!1,d.disabled=!1,"left"===e?o.focus():d.focus(),1===C[_].elementsLength?(o.disabled=!0,d.disabled=!0,r.close&&l.focus()):(0===C[_].currentIndex&&(o.disabled=!0,d.focus()),C[_].currentIndex===C[_].elementsLength-1&&(d.disabled=!0,o.focus()))):r.close&&l.focus(),t=a.querySelectorAll(".tobii > button:not(:disabled)"),m=t[0],h=1===t.length?t[0]:t[t.length-1]}(e)},ue=function(){return"false"===a.getAttribute("aria-hidden")},ce=function(){return"ontouchstart"in window},pe=function(e){return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.nodeName)||e===o||e===d||e===l||1===C[_].elementsLength};return function(e){r=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M14 18l-6-6 6-6"/></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M10 6l6 6-6 6"/></svg>'],navLabel:["Previous image","Next image"],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 6l12 12M6 18L18 6"/></svg>',closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!0,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M21 16v5h-5"/><path d="M8 21H3v-5"/><path d="M16 3h5v5"/><path d="M3 8V3h5"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return e&&Object.keys(e).forEach((function(r){t[r]=e[r]})),t}(e),a||P();var t=document.querySelectorAll(r.selector);if(!t)throw new Error("Ups, I can't find the selector "+r.selector+".");Array.prototype.forEach.call(t,(function(e){T(e)}))}(e),{open:Y,prev:D,next:U,close:M,add:T,remove:k,destroy:function(e){ue()&&M();var t=Object.entries(C);Array.prototype.forEach.call(t,(function(e){var t=e[1].gallery;Array.prototype.forEach.call(t,(function(e){k(e)}))})),a.parentNode.removeChild(a),C={},S=_=null,i=0,e&&e.call(this)},isOpen:ue,currentSlide:function(){return C[_].currentIndex},selectGroup:function(e){if(ue())throw new Error("Ups, I can't do this. Tobii is open.");if(e){if(e&&!Object.prototype.hasOwnProperty.call(C,e))throw new Error("Ups, I don't have a group called \""+e+'".');_=e}},currentGroup:function(){return null===_?S:_}}}}));